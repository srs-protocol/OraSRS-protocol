{
  "_format": "hh-sol-artifact-1",
  "contractName": "ThreatBatch",
  "sourceName": "contracts/ThreatBatch.sol",
  "abi": [
    {
      "inputs": [],
      "stateMutability": "nonpayable",
      "type": "constructor"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "owner",
          "type": "address"
        }
      ],
      "name": "OwnableInvalidOwner",
      "type": "error"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "account",
          "type": "address"
        }
      ],
      "name": "OwnableUnauthorizedAccount",
      "type": "error"
    },
    {
      "inputs": [],
      "name": "ReentrancyGuardReentrantCall",
      "type": "error"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "address",
          "name": "previousOwner",
          "type": "address"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "newOwner",
          "type": "address"
        }
      ],
      "name": "OwnershipTransferred",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": false,
          "internalType": "string",
          "name": "ip",
          "type": "string"
        },
        {
          "indexed": false,
          "internalType": "uint16",
          "name": "newScore",
          "type": "uint16"
        },
        {
          "indexed": false,
          "internalType": "uint16",
          "name": "newOffenseCount",
          "type": "uint16"
        },
        {
          "indexed": false,
          "internalType": "uint40",
          "name": "lastOffenseTime",
          "type": "uint40"
        }
      ],
      "name": "ProfileUpdated",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": false,
          "internalType": "string[]",
          "name": "ips",
          "type": "string[]"
        },
        {
          "indexed": false,
          "internalType": "uint32[]",
          "name": "durations",
          "type": "uint32[]"
        }
      ],
      "name": "PunishBatch",
      "type": "event"
    },
    {
      "inputs": [],
      "name": "MAX_BATCH_SIZE",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "TIER_1",
      "outputs": [
        {
          "internalType": "uint32",
          "name": "",
          "type": "uint32"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "TIER_2",
      "outputs": [
        {
          "internalType": "uint32",
          "name": "",
          "type": "uint32"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "TIER_3",
      "outputs": [
        {
          "internalType": "uint32",
          "name": "",
          "type": "uint32"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "string",
          "name": "ip",
          "type": "string"
        }
      ],
      "name": "emergencyClearProfile",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint16",
          "name": "offenseCount",
          "type": "uint16"
        }
      ],
      "name": "getBanDuration",
      "outputs": [
        {
          "internalType": "uint32",
          "name": "",
          "type": "uint32"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "string",
          "name": "ip",
          "type": "string"
        }
      ],
      "name": "getProfile",
      "outputs": [
        {
          "internalType": "uint40",
          "name": "",
          "type": "uint40"
        },
        {
          "internalType": "uint16",
          "name": "",
          "type": "uint16"
        },
        {
          "internalType": "uint16",
          "name": "",
          "type": "uint16"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "string[]",
          "name": "ips",
          "type": "string[]"
        }
      ],
      "name": "getProfilesBatch",
      "outputs": [
        {
          "internalType": "uint40[]",
          "name": "",
          "type": "uint40[]"
        },
        {
          "internalType": "uint16[]",
          "name": "",
          "type": "uint16[]"
        },
        {
          "internalType": "uint16[]",
          "name": "",
          "type": "uint16[]"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "owner",
      "outputs": [
        {
          "internalType": "address",
          "name": "",
          "type": "address"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "string",
          "name": "",
          "type": "string"
        }
      ],
      "name": "profiles",
      "outputs": [
        {
          "internalType": "uint40",
          "name": "lastOffenseTime",
          "type": "uint40"
        },
        {
          "internalType": "uint16",
          "name": "offenseCount",
          "type": "uint16"
        },
        {
          "internalType": "uint16",
          "name": "riskScore",
          "type": "uint16"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "renounceOwnership",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "string[]",
          "name": "ips",
          "type": "string[]"
        },
        {
          "internalType": "uint16[]",
          "name": "scores",
          "type": "uint16[]"
        }
      ],
      "name": "reportBatch",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "newOwner",
          "type": "address"
        }
      ],
      "name": "transferOwnership",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    }
  ],
  "bytecode": "0x60e080604052346100d85733156100c25760008054336001600160a01b03198216811783556040519290916001600160a01b0316907f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e09080a360018055620151806080526203f48060a05262093a8060c052610d5590816100de82396080518181816103ab015281816107850152610c83015260a05181818161081601528181610a7e0152610cae015260c05181818161036a0152818161084e0152610cd20152f35b631e4fbdf760e01b815260006004820152602490fd5b600080fdfe6080604052600436101561001257600080fd5b6000803560e01c80630de98693146102b05780631d2a056114610a615780634408f7a61461047b578063715018a6146104215780638da5cb5b146103fa5780639099cdd4146103cf5780639dd584851461038e578063a2f69a591461034d578063c680be7114610313578063cba521e2146102b0578063cfdbf25414610294578063e3eaf41e1461013a5763f2fde38b146100ac57600080fd5b34610137576020366003190112610137576004356001600160a01b0381811691829003610133576100db610d1c565b811561011a5782546001600160a01b0319811683178455167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08380a380f35b604051631e4fbdf760e01b815260048101849052602490fd5b8280fd5b80fd5b5034610137576020806003193601126102905760043567ffffffffffffffff81116101335761016d903690600401610b64565b909161018061017b83610bf0565b610aa2565b9282845261018d83610bf0565b8483019290601f19013684376101a284610cf4565b916101ac85610cf4565b94875b81811061022257505050604051958695606087019060608852518091526080870194915b818110610204575050508483039085015261020092916101f291610bb8565b908382036040850152610bb8565b0390f35b825164ffffffffff16865288975094830194918301916001016101d3565b808461023760019385879c98999a9b9c610c08565b9190826040519384928337810160028152030190205464ffffffffff811661025f8388610c60565b5261ffff90818160281c16610274848b610c60565b5260381c16610283828b610c60565b52019695949392966101af565b5080fd5b5034610137578060031936011261013757602060405160648152f35b5034610137576102d760206102c436610b25565b8160405193828580945193849201610b95565b600290820190815203019020546040805164ffffffffff8316815261ffff602884901c8116602083015260389390931c90921690820152606090f35b5034610137576020366003190112610137576004359061ffff8216820361013757602061033f83610c74565b63ffffffff60405191168152f35b5034610137578060031936011261013757602060405163ffffffff7f0000000000000000000000000000000000000000000000000000000000000000168152f35b5034610137578060031936011261013757602060405163ffffffff7f0000000000000000000000000000000000000000000000000000000000000000168152f35b503461013757806103ec60206103e436610b25565b6102c4610d1c565b810160028152030190205580f35b5034610137578060031936011261013757546040516001600160a01b039091168152602090f35b503461013757806003193601126101375761043a610d1c565b80546001600160a01b03198116825581906001600160a01b03167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08280a380f35b50346101375760403660031901126101375760043567ffffffffffffffff8111610290576104ad903690600401610b64565b9060243567ffffffffffffffff8111610a5d576104ce903690600401610b64565b6104d9929192610d1c565b600260015414610a4b576002600155808403610a145783156109e157606484116109aa5761050b61017b859395610bf0565b9282845261051883610bf0565b601f1901366020860137855b83811061063d575050506040519281604085016040865252606084019060608360051b86010192819287925b8284106105c4575050505050828103602084015260208083519283815201920190845b8181106105a857857f8e58b7592d7b692631768ae5d8dea0e5563f7ed94207710cb07e4717a36ec60d86860387a16001805580f35b825163ffffffff16845260209384019390920191600101610573565b9091929394605f198882030183528535601e1983360301811215610639578201906020823592019167ffffffffffffffff8111610635578036038313610635576020828280600196849695859652848401378d838284010152601f8019910116010197019301940192919390610550565b8a80fd5b8980fd5b61065461064d8286899799610c08565b3691610ade565b60405160208183516106698183858801610b95565b81016002815203019020805461ffff8160381c169086851015610996578460051b86013561ffff81168091036109925782018092116109485761ffff821161095c5761ffff60381b8260381b1661ffff60381b19821617835564ffffffffff610e1081831601116109485764ffffffffff818116610e1001164211156108c7575050805461ffff808260281c1610156108895761ffff808260281c161461087557600193927f5de4a66f96f22cda022e4bcaba6d2c64108aa065e631f9765e464524c23db1e19264ffffffffff928342169066ffff00000000008861ffff8360281c160160281b169066ffffffffffffff1916171781555b5461ffff8160281c168681146000146107fd5761077e868c610c60565b63ffffffff7f00000000000000000000000000000000000000000000000000000000000000001690525b604051938492608092838552855180948601526107ce8460a09760208989019101610b95565b603882901c61ffff1660208601526040850152166060830152601f01601f19168101030190a101949294610524565b6002810361083d5761080f868c610c60565b63ffffffff7f00000000000000000000000000000000000000000000000000000000000000001690526107a8565b610847868c610c60565b63ffffffff7f00000000000000000000000000000000000000000000000000000000000000001690526107a8565b634e487b7160e01b8a52601160045260248afd5b60405162461bcd60e51b81526020600482015260166024820152754f6666656e736520636f756e74206f766572666c6f7760501b6044820152606490fd5b927f5de4a66f96f22cda022e4bcaba6d2c64108aa065e631f9765e464524c23db1e192826001969561ffff61ffff60381b64ffffffffff9660381b1661ffff60381b1983161760281c161561091e575b5050610761565b61ffff60381b650100000000009260381b169068ffffffff00000000001916171781553880610917565b634e487b7160e01b8b52601160045260248bfd5b60405162461bcd60e51b815260206004820152600e60248201526d53636f7265206f766572666c6f7760901b6044820152606490fd5b8b80fd5b634e487b7160e01b8b52603260045260248bfd5b60405162461bcd60e51b815260206004820152600f60248201526e426174636820746f6f206c6172676560881b6044820152606490fd5b60405162461bcd60e51b815260206004820152600b60248201526a08adae0e8f240c4c2e8c6d60ab1b6044820152606490fd5b60405162461bcd60e51b815260206004820152600f60248201526e098cadccee8d040dad2e6dac2e8c6d608b1b6044820152606490fd5b604051633ee5aeb560e01b8152600490fd5b8380fd5b5034610137578060031936011261013757602060405163ffffffff7f0000000000000000000000000000000000000000000000000000000000000000168152f35b6040519190601f01601f1916820167ffffffffffffffff811183821017610ac857604052565b634e487b7160e01b600052604160045260246000fd5b92919267ffffffffffffffff8211610ac857610b03601f8301601f1916602001610aa2565b9382855282820111610b2057816000926020928387013784010152565b600080fd5b6020600319820112610b20576004359067ffffffffffffffff8211610b205780602383011215610b2057816024610b6193600401359101610ade565b90565b9181601f84011215610b205782359167ffffffffffffffff8311610b20576020808501948460051b010111610b2057565b60005b838110610ba85750506000910152565b8181015183820152602001610b98565b90815180825260208080930193019160005b828110610bd8575050505090565b835161ffff1685529381019392810192600101610bca565b67ffffffffffffffff8111610ac85760051b60200190565b9190811015610c4a5760051b81013590601e1981360301821215610b2057019081359167ffffffffffffffff8311610b20576020018236038113610b20579190565b634e487b7160e01b600052603260045260246000fd5b8051821015610c4a5760209160051b010190565b61ffff1660018103610ca557507f000000000000000000000000000000000000000000000000000000000000000090565b600203610cd0577f000000000000000000000000000000000000000000000000000000000000000090565b7f000000000000000000000000000000000000000000000000000000000000000090565b90610d0161017b83610bf0565b8281528092610d12601f1991610bf0565b0190602036910137565b6000546001600160a01b03163303610d3057565b60405163118cdaa760e01b8152336004820152602490fdfea164736f6c6343000818000a",
  "deployedBytecode": "0x6080604052600436101561001257600080fd5b6000803560e01c80630de98693146102b05780631d2a056114610a615780634408f7a61461047b578063715018a6146104215780638da5cb5b146103fa5780639099cdd4146103cf5780639dd584851461038e578063a2f69a591461034d578063c680be7114610313578063cba521e2146102b0578063cfdbf25414610294578063e3eaf41e1461013a5763f2fde38b146100ac57600080fd5b34610137576020366003190112610137576004356001600160a01b0381811691829003610133576100db610d1c565b811561011a5782546001600160a01b0319811683178455167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08380a380f35b604051631e4fbdf760e01b815260048101849052602490fd5b8280fd5b80fd5b5034610137576020806003193601126102905760043567ffffffffffffffff81116101335761016d903690600401610b64565b909161018061017b83610bf0565b610aa2565b9282845261018d83610bf0565b8483019290601f19013684376101a284610cf4565b916101ac85610cf4565b94875b81811061022257505050604051958695606087019060608852518091526080870194915b818110610204575050508483039085015261020092916101f291610bb8565b908382036040850152610bb8565b0390f35b825164ffffffffff16865288975094830194918301916001016101d3565b808461023760019385879c98999a9b9c610c08565b9190826040519384928337810160028152030190205464ffffffffff811661025f8388610c60565b5261ffff90818160281c16610274848b610c60565b5260381c16610283828b610c60565b52019695949392966101af565b5080fd5b5034610137578060031936011261013757602060405160648152f35b5034610137576102d760206102c436610b25565b8160405193828580945193849201610b95565b600290820190815203019020546040805164ffffffffff8316815261ffff602884901c8116602083015260389390931c90921690820152606090f35b5034610137576020366003190112610137576004359061ffff8216820361013757602061033f83610c74565b63ffffffff60405191168152f35b5034610137578060031936011261013757602060405163ffffffff7f0000000000000000000000000000000000000000000000000000000000000000168152f35b5034610137578060031936011261013757602060405163ffffffff7f0000000000000000000000000000000000000000000000000000000000000000168152f35b503461013757806103ec60206103e436610b25565b6102c4610d1c565b810160028152030190205580f35b5034610137578060031936011261013757546040516001600160a01b039091168152602090f35b503461013757806003193601126101375761043a610d1c565b80546001600160a01b03198116825581906001600160a01b03167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08280a380f35b50346101375760403660031901126101375760043567ffffffffffffffff8111610290576104ad903690600401610b64565b9060243567ffffffffffffffff8111610a5d576104ce903690600401610b64565b6104d9929192610d1c565b600260015414610a4b576002600155808403610a145783156109e157606484116109aa5761050b61017b859395610bf0565b9282845261051883610bf0565b601f1901366020860137855b83811061063d575050506040519281604085016040865252606084019060608360051b86010192819287925b8284106105c4575050505050828103602084015260208083519283815201920190845b8181106105a857857f8e58b7592d7b692631768ae5d8dea0e5563f7ed94207710cb07e4717a36ec60d86860387a16001805580f35b825163ffffffff16845260209384019390920191600101610573565b9091929394605f198882030183528535601e1983360301811215610639578201906020823592019167ffffffffffffffff8111610635578036038313610635576020828280600196849695859652848401378d838284010152601f8019910116010197019301940192919390610550565b8a80fd5b8980fd5b61065461064d8286899799610c08565b3691610ade565b60405160208183516106698183858801610b95565b81016002815203019020805461ffff8160381c169086851015610996578460051b86013561ffff81168091036109925782018092116109485761ffff821161095c5761ffff60381b8260381b1661ffff60381b19821617835564ffffffffff610e1081831601116109485764ffffffffff818116610e1001164211156108c7575050805461ffff808260281c1610156108895761ffff808260281c161461087557600193927f5de4a66f96f22cda022e4bcaba6d2c64108aa065e631f9765e464524c23db1e19264ffffffffff928342169066ffff00000000008861ffff8360281c160160281b169066ffffffffffffff1916171781555b5461ffff8160281c168681146000146107fd5761077e868c610c60565b63ffffffff7f00000000000000000000000000000000000000000000000000000000000000001690525b604051938492608092838552855180948601526107ce8460a09760208989019101610b95565b603882901c61ffff1660208601526040850152166060830152601f01601f19168101030190a101949294610524565b6002810361083d5761080f868c610c60565b63ffffffff7f00000000000000000000000000000000000000000000000000000000000000001690526107a8565b610847868c610c60565b63ffffffff7f00000000000000000000000000000000000000000000000000000000000000001690526107a8565b634e487b7160e01b8a52601160045260248afd5b60405162461bcd60e51b81526020600482015260166024820152754f6666656e736520636f756e74206f766572666c6f7760501b6044820152606490fd5b927f5de4a66f96f22cda022e4bcaba6d2c64108aa065e631f9765e464524c23db1e192826001969561ffff61ffff60381b64ffffffffff9660381b1661ffff60381b1983161760281c161561091e575b5050610761565b61ffff60381b650100000000009260381b169068ffffffff00000000001916171781553880610917565b634e487b7160e01b8b52601160045260248bfd5b60405162461bcd60e51b815260206004820152600e60248201526d53636f7265206f766572666c6f7760901b6044820152606490fd5b8b80fd5b634e487b7160e01b8b52603260045260248bfd5b60405162461bcd60e51b815260206004820152600f60248201526e426174636820746f6f206c6172676560881b6044820152606490fd5b60405162461bcd60e51b815260206004820152600b60248201526a08adae0e8f240c4c2e8c6d60ab1b6044820152606490fd5b60405162461bcd60e51b815260206004820152600f60248201526e098cadccee8d040dad2e6dac2e8c6d608b1b6044820152606490fd5b604051633ee5aeb560e01b8152600490fd5b8380fd5b5034610137578060031936011261013757602060405163ffffffff7f0000000000000000000000000000000000000000000000000000000000000000168152f35b6040519190601f01601f1916820167ffffffffffffffff811183821017610ac857604052565b634e487b7160e01b600052604160045260246000fd5b92919267ffffffffffffffff8211610ac857610b03601f8301601f1916602001610aa2565b9382855282820111610b2057816000926020928387013784010152565b600080fd5b6020600319820112610b20576004359067ffffffffffffffff8211610b205780602383011215610b2057816024610b6193600401359101610ade565b90565b9181601f84011215610b205782359167ffffffffffffffff8311610b20576020808501948460051b010111610b2057565b60005b838110610ba85750506000910152565b8181015183820152602001610b98565b90815180825260208080930193019160005b828110610bd8575050505090565b835161ffff1685529381019392810192600101610bca565b67ffffffffffffffff8111610ac85760051b60200190565b9190811015610c4a5760051b81013590601e1981360301821215610b2057019081359167ffffffffffffffff8311610b20576020018236038113610b20579190565b634e487b7160e01b600052603260045260246000fd5b8051821015610c4a5760209160051b010190565b61ffff1660018103610ca557507f000000000000000000000000000000000000000000000000000000000000000090565b600203610cd0577f000000000000000000000000000000000000000000000000000000000000000090565b7f000000000000000000000000000000000000000000000000000000000000000090565b90610d0161017b83610bf0565b8281528092610d12601f1991610bf0565b0190602036910137565b6000546001600160a01b03163303610d3057565b60405163118cdaa760e01b8152336004820152602490fdfea164736f6c6343000818000a",
  "linkReferences": {},
  "deployedLinkReferences": {}
}
