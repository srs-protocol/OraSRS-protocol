{
  "_format": "hh-sol-artifact-1",
  "contractName": "OptimizedThreatRegistry",
  "sourceName": "contracts/OptimizedThreatRegistry.sol",
  "abi": [
    {
      "inputs": [],
      "stateMutability": "nonpayable",
      "type": "constructor"
    },
    {
      "inputs": [],
      "name": "AccessControlBadConfirmation",
      "type": "error"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "account",
          "type": "address"
        },
        {
          "internalType": "bytes32",
          "name": "neededRole",
          "type": "bytes32"
        }
      ],
      "name": "AccessControlUnauthorizedAccount",
      "type": "error"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "bytes32",
          "name": "root",
          "type": "bytes32"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "timestamp",
          "type": "uint256"
        }
      ],
      "name": "MerkleRootUpdated",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "bytes32",
          "name": "role",
          "type": "bytes32"
        },
        {
          "indexed": true,
          "internalType": "bytes32",
          "name": "previousAdminRole",
          "type": "bytes32"
        },
        {
          "indexed": true,
          "internalType": "bytes32",
          "name": "newAdminRole",
          "type": "bytes32"
        }
      ],
      "name": "RoleAdminChanged",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "bytes32",
          "name": "role",
          "type": "bytes32"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "account",
          "type": "address"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "sender",
          "type": "address"
        }
      ],
      "name": "RoleGranted",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "bytes32",
          "name": "role",
          "type": "bytes32"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "account",
          "type": "address"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "sender",
          "type": "address"
        }
      ],
      "name": "RoleRevoked",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "bytes4",
          "name": "ip",
          "type": "bytes4"
        }
      ],
      "name": "ThreatRemoved",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "bytes4",
          "name": "ip",
          "type": "bytes4"
        },
        {
          "indexed": false,
          "internalType": "uint8",
          "name": "riskLevel",
          "type": "uint8"
        },
        {
          "indexed": false,
          "internalType": "uint64",
          "name": "expiry",
          "type": "uint64"
        },
        {
          "indexed": false,
          "internalType": "uint8",
          "name": "mask",
          "type": "uint8"
        }
      ],
      "name": "ThreatUpdated",
      "type": "event"
    },
    {
      "inputs": [],
      "name": "DEFAULT_ADMIN_ROLE",
      "outputs": [
        {
          "internalType": "bytes32",
          "name": "",
          "type": "bytes32"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "ORACLE_ROLE",
      "outputs": [
        {
          "internalType": "bytes32",
          "name": "",
          "type": "bytes32"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes32",
          "name": "role",
          "type": "bytes32"
        }
      ],
      "name": "getRoleAdmin",
      "outputs": [
        {
          "internalType": "bytes32",
          "name": "",
          "type": "bytes32"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes4",
          "name": "ip",
          "type": "bytes4"
        }
      ],
      "name": "getThreat",
      "outputs": [
        {
          "components": [
            {
              "internalType": "uint64",
              "name": "expiry",
              "type": "uint64"
            },
            {
              "internalType": "uint8",
              "name": "riskLevel",
              "type": "uint8"
            },
            {
              "internalType": "uint8",
              "name": "mask",
              "type": "uint8"
            },
            {
              "internalType": "uint16",
              "name": "sourceMask",
              "type": "uint16"
            }
          ],
          "internalType": "struct OptimizedThreatRegistry.ThreatInfo",
          "name": "",
          "type": "tuple"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes32",
          "name": "role",
          "type": "bytes32"
        },
        {
          "internalType": "address",
          "name": "account",
          "type": "address"
        }
      ],
      "name": "grantRole",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes32",
          "name": "role",
          "type": "bytes32"
        },
        {
          "internalType": "address",
          "name": "account",
          "type": "address"
        }
      ],
      "name": "hasRole",
      "outputs": [
        {
          "internalType": "bool",
          "name": "",
          "type": "bool"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes4",
          "name": "ip",
          "type": "bytes4"
        }
      ],
      "name": "isThreat",
      "outputs": [
        {
          "internalType": "bool",
          "name": "",
          "type": "bool"
        },
        {
          "internalType": "uint8",
          "name": "",
          "type": "uint8"
        },
        {
          "internalType": "uint64",
          "name": "",
          "type": "uint64"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "merkleRoot",
      "outputs": [
        {
          "internalType": "bytes32",
          "name": "",
          "type": "bytes32"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes4[]",
          "name": "ips",
          "type": "bytes4[]"
        }
      ],
      "name": "pruneExpired",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes32",
          "name": "role",
          "type": "bytes32"
        },
        {
          "internalType": "address",
          "name": "callerConfirmation",
          "type": "address"
        }
      ],
      "name": "renounceRole",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes32",
          "name": "role",
          "type": "bytes32"
        },
        {
          "internalType": "address",
          "name": "account",
          "type": "address"
        }
      ],
      "name": "revokeRole",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes4",
          "name": "interfaceId",
          "type": "bytes4"
        }
      ],
      "name": "supportsInterface",
      "outputs": [
        {
          "internalType": "bool",
          "name": "",
          "type": "bool"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes4",
          "name": "",
          "type": "bytes4"
        }
      ],
      "name": "threats",
      "outputs": [
        {
          "internalType": "uint64",
          "name": "expiry",
          "type": "uint64"
        },
        {
          "internalType": "uint8",
          "name": "riskLevel",
          "type": "uint8"
        },
        {
          "internalType": "uint8",
          "name": "mask",
          "type": "uint8"
        },
        {
          "internalType": "uint16",
          "name": "sourceMask",
          "type": "uint16"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes32",
          "name": "_root",
          "type": "bytes32"
        }
      ],
      "name": "updateMerkleRoot",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes4[]",
          "name": "ips",
          "type": "bytes4[]"
        },
        {
          "internalType": "uint8[]",
          "name": "levels",
          "type": "uint8[]"
        },
        {
          "internalType": "uint8[]",
          "name": "masks",
          "type": "uint8[]"
        },
        {
          "internalType": "uint16[]",
          "name": "sources",
          "type": "uint16[]"
        },
        {
          "internalType": "uint64",
          "name": "duration",
          "type": "uint64"
        }
      ],
      "name": "updateThreatBatch",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    }
  ],
  "bytecode": "0x60806040523461002c5761001233610031565b5061001c336100af565b50604051610b7290816101508239f35b600080fd5b6001600160a01b031660008181527fad3228b676f7d3cd4284a5443f17f1962b36e491b30a40b2405849e597ba5fb5602052604081205490919060ff166100ab57818052816020526040822081835260205260408220600160ff198254161790553391600080516020610cc28339815191528180a4600190565b5090565b6001600160a01b031660008181527fa629f6981c2f6895a67dc766e8e03ff72d04a413d0d8773a3ca56e9e474032c160205260408120549091907f68e79a7bf1e0bc45d0a330c573bc367f9cf464fd326078812f301165fbda4ef19060ff1661014a57808352826020526040832082845260205260408320600160ff19825416179055600080516020610cc2833981519152339380a4600190565b50509056fe608080604052600436101561001357600080fd5b600090813560e01c90816301ffc9a7146108235750806307e2cea5146107e8578063248a9ca3146107bc5780632eb4a7ab1461079e5780632f2ef1a1146106a55780632f2ff15d1461067657806331cf430914610621578063359d577a146102f957806336568abe146102bf57806341e6d71d146102545780634783f0ef146102065780635a92e5891461015257806391d1485414610117578063a217fddf146100fb5763d547741f146100c657600080fd5b346100f8576100f46100d7366108b1565b90808452836020526100ef6001604086200154610a4c565b610af0565b5080f35b80fd5b50346100f857806003193601126100f857602090604051908152f35b50346100f85760ff604060209261012d366108b1565b9082528185528282206001600160a01b03909116825284522054604051911615158152f35b50346100f85760203660031901126100f85760043563ffffffff60e01b811680910361020257816040916080936060610189610912565b82815282602082015282868201520152815260016020522060606101ab610912565b915460ff6001600160401b038216938481528160208201818560401c1681526040830192828660481c16845261ffff968791019560501c168552604051968752511660208601525116604084015251166060820152f35b5080fd5b50346100f85760203660031901126100f8576004356102236109d2565b806002557fecb6e184c8c1ff50ab199b30650a76b7eb56fe2f261becc6284e0a3a1707be486020604051428152a280f35b50346100f85760203660031901126100f85760043563ffffffff60e01b81168091036102025781604091608093526001602052205461ffff604051916001600160401b038116835260ff8160401c16602084015260ff8160481c16604084015260501c166060820152f35b50346100f8576102ce366108b1565b336001600160a01b038216036102e7576100f491610af0565b60405163334bd91960e11b8152600490fd5b50346100f85760a03660031901126100f8576004356001600160401b0381116102025761032a90369060040161087c565b906024356001600160401b03811161061d5761034a90369060040161087c565b90926044356001600160401b0381116106195761036b90369060040161087c565b906064356001600160401b0381116106155761038b90369060040161087c565b939094608435916001600160401b0383168303610611576103aa6109d2565b81811480610608575b806105ff575b156105c857895b8181106103cb578a80f35b806103f56103f082866103ea8f968f90896103e5926108d7565b6108fd565b956108d7565b6109c4565b60ff811615610585576001600160e01b031983168d52600160205260408d2080549390426001600160401b0386161180610574575b15610536576001600160401b0362093a808187160111610522578b91899161047e868e60ff60481b8f6103f084610474926001600160401b038f8162093a809116015b169a6108d7565b60481b16966108d7565b359261ffff8416840361051c576104f66103f0888f8f60ff9660019d7fbf9c82a2e49583ea8990e5994f020f8ff61f2a9a5ae067d4df0d0fe8d76b78639b8d68ff00000000000000008a60609e61ffff60501b9060501b16946bffffffffffffffffffffffff1916179160401b1617171790556108d7565b908260405197168752602087015216604085015263ffffffff60e01b1692a25b016103c0565b50508f80fd5b634e487b7160e01b8f52601160045260248ffd5b6001600160401b03881642014211610522578b91899161047e868e60ff60481b8f6103f08f610474926001600160401b03808089941642011661046d565b50600360ff8660401c16101561042a565b5060019163ffffffff60e01b16808d52826020528c60408120557f75ffe9fe5fbb1f7406f31f5657e09f354ba90e288df44302b3e7fc1397b6f3888d80a2610516565b60405162461bcd60e51b815260206004820152600f60248201526e098cadccee8d040dad2e6dac2e8c6d608b1b6044820152606490fd5b508581146103b9565b508481146103b3565b8980fd5b8780fd5b8580fd5b8380fd5b50346100f85760203660031901126100f857600435906001600160e01b0319821682036100f857606060ff6001600160401b0361065d85610947565b9193906040519415158552166020840152166040820152f35b50346100f8576100f4610688366108b1565b90808452836020526106a06001604086200154610a4c565b610a72565b50346100f857602080600319360112610202576001600160401b0360043581811161061d576106d890369060040161087c565b9091845b8281106106e7578580f35b6001906001600160e01b0319806107026103e584888a6108d7565b16885282808852428560408b20541611158061077a575b610726575b5050016106dc565b816107356103e585898b6108d7565b168952875287604081205561074e6103e58387896108d7565b167f75ffe9fe5fbb1f7406f31f5657e09f354ba90e288df44302b3e7fc1397b6f3888880a2388061071e565b508161078a6103e585898b6108d7565b1689528088528460408a2054161515610719565b50346100f857806003193601126100f8576020600254604051908152f35b50346100f85760203660031901126100f857600160406020926004358152808452200154604051908152f35b50346100f857806003193601126100f85760206040517f68e79a7bf1e0bc45d0a330c573bc367f9cf464fd326078812f301165fbda4ef18152f35b9050346102025760203660031901126102025760043563ffffffff60e01b81168091036108785760209250637965db0b60e01b8114908115610867575b5015158152f35b6301ffc9a760e01b14905038610860565b8280fd5b9181601f840112156108ac578235916001600160401b0383116108ac576020808501948460051b0101116108ac57565b600080fd5b60409060031901126108ac57600435906024356001600160a01b03811681036108ac5790565b91908110156108e75760051b0190565b634e487b7160e01b600052603260045260246000fd5b356001600160e01b0319811681036108ac5790565b60405190608082018281106001600160401b0382111761093157604052565b634e487b7160e01b600052604160045260246000fd5b63ffffffff60e01b1660005260016020526040600020610965610912565b9054906001600160401b03821690818152606061ffff60ff8560401c169485602085015260ff8160481c16604085015260501c16910152428111806109bb575b6109b6575050600090600090600090565b600192565b508115156109a5565b3560ff811681036108ac5790565b3360009081527fa629f6981c2f6895a67dc766e8e03ff72d04a413d0d8773a3ca56e9e474032c160205260409020547f68e79a7bf1e0bc45d0a330c573bc367f9cf464fd326078812f301165fbda4ef19060ff1615610a2e5750565b6044906040519063e2517d3f60e01b82523360048301526024820152fd5b80600052600060205260406000203360005260205260ff6040600020541615610a2e5750565b9060009180835282602052604083209160018060a01b03169182845260205260ff60408420541615600014610aeb57808352826020526040832082845260205260408320600160ff198254161790557f2f8788117e7eff1d82e926ec794901d17c78024a50270940304540a733656f0d339380a4600190565b505090565b9060009180835282602052604083209160018060a01b03169182845260205260ff604084205416600014610aeb5780835282602052604083208284526020526040832060ff1981541690557ff6391f5c32d9c69d2a47ea670b442974b53935d1edc7fd64eb21e047a839171b339380a460019056fea164736f6c6343000818000a2f8788117e7eff1d82e926ec794901d17c78024a50270940304540a733656f0d",
  "deployedBytecode": "0x608080604052600436101561001357600080fd5b600090813560e01c90816301ffc9a7146108235750806307e2cea5146107e8578063248a9ca3146107bc5780632eb4a7ab1461079e5780632f2ef1a1146106a55780632f2ff15d1461067657806331cf430914610621578063359d577a146102f957806336568abe146102bf57806341e6d71d146102545780634783f0ef146102065780635a92e5891461015257806391d1485414610117578063a217fddf146100fb5763d547741f146100c657600080fd5b346100f8576100f46100d7366108b1565b90808452836020526100ef6001604086200154610a4c565b610af0565b5080f35b80fd5b50346100f857806003193601126100f857602090604051908152f35b50346100f85760ff604060209261012d366108b1565b9082528185528282206001600160a01b03909116825284522054604051911615158152f35b50346100f85760203660031901126100f85760043563ffffffff60e01b811680910361020257816040916080936060610189610912565b82815282602082015282868201520152815260016020522060606101ab610912565b915460ff6001600160401b038216938481528160208201818560401c1681526040830192828660481c16845261ffff968791019560501c168552604051968752511660208601525116604084015251166060820152f35b5080fd5b50346100f85760203660031901126100f8576004356102236109d2565b806002557fecb6e184c8c1ff50ab199b30650a76b7eb56fe2f261becc6284e0a3a1707be486020604051428152a280f35b50346100f85760203660031901126100f85760043563ffffffff60e01b81168091036102025781604091608093526001602052205461ffff604051916001600160401b038116835260ff8160401c16602084015260ff8160481c16604084015260501c166060820152f35b50346100f8576102ce366108b1565b336001600160a01b038216036102e7576100f491610af0565b60405163334bd91960e11b8152600490fd5b50346100f85760a03660031901126100f8576004356001600160401b0381116102025761032a90369060040161087c565b906024356001600160401b03811161061d5761034a90369060040161087c565b90926044356001600160401b0381116106195761036b90369060040161087c565b906064356001600160401b0381116106155761038b90369060040161087c565b939094608435916001600160401b0383168303610611576103aa6109d2565b81811480610608575b806105ff575b156105c857895b8181106103cb578a80f35b806103f56103f082866103ea8f968f90896103e5926108d7565b6108fd565b956108d7565b6109c4565b60ff811615610585576001600160e01b031983168d52600160205260408d2080549390426001600160401b0386161180610574575b15610536576001600160401b0362093a808187160111610522578b91899161047e868e60ff60481b8f6103f084610474926001600160401b038f8162093a809116015b169a6108d7565b60481b16966108d7565b359261ffff8416840361051c576104f66103f0888f8f60ff9660019d7fbf9c82a2e49583ea8990e5994f020f8ff61f2a9a5ae067d4df0d0fe8d76b78639b8d68ff00000000000000008a60609e61ffff60501b9060501b16946bffffffffffffffffffffffff1916179160401b1617171790556108d7565b908260405197168752602087015216604085015263ffffffff60e01b1692a25b016103c0565b50508f80fd5b634e487b7160e01b8f52601160045260248ffd5b6001600160401b03881642014211610522578b91899161047e868e60ff60481b8f6103f08f610474926001600160401b03808089941642011661046d565b50600360ff8660401c16101561042a565b5060019163ffffffff60e01b16808d52826020528c60408120557f75ffe9fe5fbb1f7406f31f5657e09f354ba90e288df44302b3e7fc1397b6f3888d80a2610516565b60405162461bcd60e51b815260206004820152600f60248201526e098cadccee8d040dad2e6dac2e8c6d608b1b6044820152606490fd5b508581146103b9565b508481146103b3565b8980fd5b8780fd5b8580fd5b8380fd5b50346100f85760203660031901126100f857600435906001600160e01b0319821682036100f857606060ff6001600160401b0361065d85610947565b9193906040519415158552166020840152166040820152f35b50346100f8576100f4610688366108b1565b90808452836020526106a06001604086200154610a4c565b610a72565b50346100f857602080600319360112610202576001600160401b0360043581811161061d576106d890369060040161087c565b9091845b8281106106e7578580f35b6001906001600160e01b0319806107026103e584888a6108d7565b16885282808852428560408b20541611158061077a575b610726575b5050016106dc565b816107356103e585898b6108d7565b168952875287604081205561074e6103e58387896108d7565b167f75ffe9fe5fbb1f7406f31f5657e09f354ba90e288df44302b3e7fc1397b6f3888880a2388061071e565b508161078a6103e585898b6108d7565b1689528088528460408a2054161515610719565b50346100f857806003193601126100f8576020600254604051908152f35b50346100f85760203660031901126100f857600160406020926004358152808452200154604051908152f35b50346100f857806003193601126100f85760206040517f68e79a7bf1e0bc45d0a330c573bc367f9cf464fd326078812f301165fbda4ef18152f35b9050346102025760203660031901126102025760043563ffffffff60e01b81168091036108785760209250637965db0b60e01b8114908115610867575b5015158152f35b6301ffc9a760e01b14905038610860565b8280fd5b9181601f840112156108ac578235916001600160401b0383116108ac576020808501948460051b0101116108ac57565b600080fd5b60409060031901126108ac57600435906024356001600160a01b03811681036108ac5790565b91908110156108e75760051b0190565b634e487b7160e01b600052603260045260246000fd5b356001600160e01b0319811681036108ac5790565b60405190608082018281106001600160401b0382111761093157604052565b634e487b7160e01b600052604160045260246000fd5b63ffffffff60e01b1660005260016020526040600020610965610912565b9054906001600160401b03821690818152606061ffff60ff8560401c169485602085015260ff8160481c16604085015260501c16910152428111806109bb575b6109b6575050600090600090600090565b600192565b508115156109a5565b3560ff811681036108ac5790565b3360009081527fa629f6981c2f6895a67dc766e8e03ff72d04a413d0d8773a3ca56e9e474032c160205260409020547f68e79a7bf1e0bc45d0a330c573bc367f9cf464fd326078812f301165fbda4ef19060ff1615610a2e5750565b6044906040519063e2517d3f60e01b82523360048301526024820152fd5b80600052600060205260406000203360005260205260ff6040600020541615610a2e5750565b9060009180835282602052604083209160018060a01b03169182845260205260ff60408420541615600014610aeb57808352826020526040832082845260205260408320600160ff198254161790557f2f8788117e7eff1d82e926ec794901d17c78024a50270940304540a733656f0d339380a4600190565b505090565b9060009180835282602052604083209160018060a01b03169182845260205260ff604084205416600014610aeb5780835282602052604083208284526020526040832060ff1981541690557ff6391f5c32d9c69d2a47ea670b442974b53935d1edc7fd64eb21e047a839171b339380a460019056fea164736f6c6343000818000a",
  "linkReferences": {},
  "deployedLinkReferences": {}
}
