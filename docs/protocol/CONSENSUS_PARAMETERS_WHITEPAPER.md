# SecurityRiskAssessment 共识参数白皮书

**版本**: 1.0  
**发布日期**: 2025年12月  
**协议**: SecurityRiskAssessment (Oracle Security Root Service)

## 摘要

本白皮书详细阐述了 SecurityRiskAssessment 协议的共识参数设计，包括三层架构的参数配置、质押机制、声誉系统和安全模型。这些参数旨在确保网络的安全性、去中心化和高效运行，同时满足中国法律法规和国产化要求。

## 1. 三层共识架构参数

### 1.1 全局根网络层 (Global Root Network Layer)
- **共识算法**: Tendermint Core 或 HotStuff (BFT)
- **节点数量**: 21 (奇数，便于BFT投票)
- **容错能力**: ≤ ⌊(n-1)/3⌋ = 6 个恶意节点
- **出块时间**: 5秒
- **网络延迟容忍**: ≤ 500ms
- **最小质押门槛**: ≥ 10,000 ORA (或等值法币)
- **质押锁定期**: ≥ 7 天
- **罚没机制**: 
  - 作恶行为: 100% 罚没
  - 离线 > 24h: 5%/天
- **投票权重**: 基于质押金额和声誉分数的复合权重

### 1.2 分区共识层 (Partition Consensus Layer)
- **共识算法**: PBFT 变种
- **节点数量**: ≤ 50 (单个分区内)
- **容错能力**: ≤ ⌊(n-1)/3⌋ = 16 个恶意节点
- **分区数量**: 动态调整，最多支持10个并行分区
- **跨分区通信**: 通过根层协调
- **功能**: 
  - 局部共识验证
  - 缓存挑战执行
  - 资源配额管理
  - 轻量级验证

### 1.3 边缘缓存层 (Edge Cache Layer)
- **质押门槛**: ≥ 100 ORA (小额质押)
- **缓存有效期**: 5 分钟
- **挑战触发**: 
  - 缓存数据 > 5 分钟
  - 被 3 个独立节点质疑
- **验证流程**: 向根层提交默克尔证明 + 时间戳
- **奖惩机制**:
  - 挑战成功: 缓存节点罚没 50% 保证金
  - 挑战者奖励: 80% 罚没金额

## 2. 质押机制参数

### 2.1 质押门槛
- **根层共识节点**: 10,000 ORA (硬性要求)
- **分区层节点**: 5,000 ORA (硬性要求)
- **边缘缓存节点**: 100 ORA (硬性要求)
- **验证节点**: 1,000 ORA (可选参与验证)

### 2.2 质押锁定期
- **最短锁定期**: 7 天 (604,800 秒)
- **提前退出**: 不允许，除非触发罚没机制
- **锁定期延长**: 恶意行为可延长锁定期

### 2.3 罚没参数
- **双签处罚**: 100% 质押金罚没
- **离线处罚**: 5% / 天 (按日累计)
- **错误验证**: 20% 质押金罚没
- **挑战失败**: 10% 质押金罚没

## 3. 声誉系统参数

### 3.1 声誉评分模型
```
reputation = base + uptime_score + accuracy_score + latency_score + contribution_score

其中：
- base = 100 (基础分)
- uptime_score = min(1.0, node.uptime / 0.95) * 30 (在线率，权重30%)
- accuracy_score = node.correct_validations / node.total_validations * 40 (正确率，权重40%)
- latency_score = max(0, 20 - node.avg_challenge_response_ms / 10) (响应速度，权重20%)
- contribution_score = node.submitted_threat_intel_count * 0.1 (贡献度，权重10%)
```

### 3.2 声誉应用规则
- **声誉 < 80**: 禁止参与共识，仅可作边缘缓存节点
- **声誉 80-120**: 正常参与共识
- **声誉 > 120**: 降低质押门槛 20%，提高收益分成
- **声誉连续 7 天 < 60**: 自动触发节点剔除流程
- **声誉恢复**: 良好表现可逐步恢复声誉

## 4. 安全模型参数

### 4.1 BFT 安全参数
- **恶意节点容忍度**: ≤ 1/3 总节点数
- **网络同步假设**: 部分同步网络模型
- **故障类型**: 
  - 崩溃故障 (Crash Fault)
  - 拜占庭故障 (Byzantine Fault)
  - 网络分区 (Network Partition)

### 4.2 活性与安全性权衡
- **安全性优先**: 在网络分区情况下优先保证安全性
- **活性保障**: 网络恢复后快速重新同步
- **恢复机制**: 
  - 快照恢复 (Snapshot Recovery)
  - 状态同步 (State Sync)

## 5. 治理参数

### 5.1 技术委员会
- **席位总数**: 7 (奇数避免平票)
- **席位分配**:
  - 企业代表: 3 席
  - 高校代表: 2 席
  - 社区代表: 2 席
- **任期**: 2 年 (可连任)
- **投票阈值**: 5/7 通过 (≥71.4%)

### 5.2 紧急治理参数
- **紧急熔断**: 2/3 委员同意 (5/7) 可暂停协议
- **紧急升级**: 2/3 委员同意可执行紧急升级
- **审计周期**: 每季度审计声誉算法

## 6. 性能参数

### 6.1 性能目标
- **TPS**: ≥ 1000 (测试网), ≥ 10000 (主网)
- **延迟**:
  - 根层共识: ≤ 5s
  - 分区共识: ≤ 2s
  - 边缘查询: ≤ 15ms
- **可用性**: ≥ 99.9%

### 6.2 资源要求
- **根层节点**:
  - CPU: ≥ 8 核
  - 内存: ≥ 32GB
  - 存储: ≥ 2TB SSD
  - 带宽: ≥ 100Mbps
- **分区层节点**:
  - CPU: ≥ 4 核
  - 内存: ≥ 16GB
  - 存储: ≥ 500GB SSD
  - 带宽: ≥ 50Mbps
- **边缘节点**:
  - CPU: ≥ 2 核
  - 内存: ≥ 8GB
  - 存储: ≥ 100GB
  - 带宽: ≥ 10Mbps

## 7. 合规参数

### 7.1 国产化要求
- **算法合规**: 支持国密算法 SM2/SM3/SM4
- **数据合规**: 数据存储于中国境内
- **认证合规**: 节点需通过区块链信息服务备案

### 7.2 审计参数
- **日志要求**: 
  - IP 地址哈希存储 (SHA3-256 + Salt)
  - 节点行为日志保留 2 年
  - 财务记录保留 5 年
- **审计频率**: 
  - 自动审计: 每日
  - 人工审计: 每季度
  - 第三方审计: 每年

## 8. 经济模型参数

### 8.1 通胀模型
- **年通胀率**: 3% (用于奖励节点)
- **奖励分配**:
  - 根层节点: 50%
  - 分区层节点: 30%
  - 边缘节点: 20%

### 8.2 费用模型
- **查询费用**: 0.01 ORA/次
- **质押费用**: 0.1% (一次性)
- **挑战费用**: 1 ORA/次

## 9. 升级路径

### 9.1 演进参数
- **Phase 1 (2025 Q3)**: 测试网，≥50 节点，TPS ≥ 1000
- **Phase 2 (2025 Q4)**: 通过等保三级认证
- **Phase 3 (2026 Q1)**: 落地 2 个政企试点
- **Phase 4 (2026 Q2)**: 主网上线

### 9.2 参数调整机制
- **社区提议**: 持有 ≥ 10,000 ORA 可提交参数调整提议
- **投票周期**: 7 天
- **通过阈值**: 66.7% 支持率 + ≥ 20% 参与率

## 10. 风险控制参数

### 10.1 熔断机制
- **TPS 超载**: 超过 150% 目标 TPS 时启动限流
- **节点失效**: 超过 33% 节点失效时启动降级模式
- **异常行为**: 检测到攻击时启动紧急响应

### 10.2 降级模式
- **性能降级**: 在高负载下优先处理高优先级交易
- **安全降级**: 在攻击下优先保证系统安全
- **可用性降级**: 在网络分区下保证基础服务可用

---

**附录 A: 参数配置示例**

```json
{
  "consensus": {
    "rootLayer": {
      "nodeCount": 21,
      "minStake": 10000,
      "lockPeriod": 604800,
      "bftTolerance": 6,
      "blockTime": 5
    },
    "partitionLayer": {
      "maxNodesPerPartition": 50,
      "maxPartitions": 10,
      "bftTolerance": 16
    },
    "edgeLayer": {
      "minStake": 100,
      "cacheTTL": 300,
      "challengeThreshold": 3
    },
    "slashing": {
      "maliciousBehavior": 1.0,
      "offlinePenalty": 0.05,
      "incorrectValidation": 0.2
    }
  }
}
```

**附录 B: 参数验证测试**

所有参数必须通过以下测试:
1. 安全性测试 - 恶意节点攻击模拟
2. 性能测试 - 压力测试和容量规划
3. 治理测试 - 委员会决策流程验证
4. 兼容性测试 - 国密算法支持验证